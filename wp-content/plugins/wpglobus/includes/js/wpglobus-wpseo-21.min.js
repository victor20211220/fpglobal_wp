var wpglobus_wpseo=function(){var r,p,e,u,c,d,g;function _(e,t,a){a=yst_escapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val()));if(""==a)return e;for(var s=-1!=a.search(" ")?a.split(" "):new Array(a),o=0;o<s.length;o++){var n=yst_clean(s[o]),l="",l=t?(n=n.replace(" ","-").toLowerCase(),new RegExp("([-/])("+n+")([-/])?")):new RegExp("(^|[ s\n\r\t.,'(\"+;!?:-]+)("+n+")($|[ s\n\r\t.,')\"+;!?:-]+)","gim");null!=e&&(e=e.replace(l,"$1<strong>$2</strong>$3"))}return e}function w(a){var e,t=jQuery.trim(yst_clean(jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+a).val())),s=jQuery("<div />"),o=jQuery("#wpseosnippet_"+a);""!=(t=""==t&&""!=wpseoMetaboxL10n.wpseo_metadesc_template?wpseoMetaboxL10n.wpseo_metadesc_template:t)?t=yst_replaceVariables(t,function(e){var t;e=s.text(e).html(),e=yst_clean(e),t=(t=wpseoMetaboxL10n.wpseo_meta_desc_length-e.length)<0?'<span class="wrong">'+t+"</span>":'<span class="good">'+t+"</span>",jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+a).html(t),e=_(e=yst_trimDesc(e),!1),o.find(".desc span.autogen").html(""),o.find(".desc span.content").html(e),y(a)}):(jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc-length_"+a).html(wpseoMetaboxL10n.wpseo_meta_desc_length),o.find(".desc span.content").html(""),y(a),e="#content",a!=WPGlobusAdmin.data.default_language&&(e="#content_"+a),jQuery(e).length&&(t=jQuery(e).val(),t=yst_clean(t)),t=_(t=""!=(e=yst_escapeFocusKw(jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+a).val())))?(e=new RegExp(e,"gim"),-1!=t.search(e)&&t.length>wpseoMetaboxL10n.wpseo_meta_desc_length?t.substr(t.search(e),wpseoMetaboxL10n.wpseo_meta_desc_length):t.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length)):t.substr(0,wpseoMetaboxL10n.wpseo_meta_desc_length),!1),t=yst_trimDesc(t),o.find(".desc span.autogen").html(t))}function y(e){var t=jQuery.trim(jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+e).val()),t=yst_escapeFocusKw(t).toLowerCase(),a="#title",s="#content";e!=WPGlobusAdmin.data.default_language&&(a="#title_"+e,s="#content_"+e);var o,n=jQuery(document).triggerHandler("wpglobus_post_name_full",{postnamefull:"#editable-post-name-full",language:e})||"#editable-post-name-full";jQuery(n).length&&(p=jQuery(n).text(),o=wpseoMetaboxL10n.wpseo_permalink_template.replace("%postname%",p).replace("http://",""));var l=new RegExp("(^|[ s\n\r\t.,'(\"+;!?:-])"+t+"($|[ s\n\r\t.,')\"+!?:;-])","gim"),r=removeLowerCaseDiacritics(t),n=new RegExp(r.replace(/\s+/g,"[-_\\//]"),"gim"),p=jQuery("#focuskwresults_"+e),r=jQuery("#wpseosnippet_"+e).find(".desc span.content").text();""!=t?(t="<p>"+wpseoMetaboxL10n.keyword_header+"</p>",t+="<ul>",jQuery(a).length&&(t+="<li>"+wpseoMetaboxL10n.article_header_text+ptest(jQuery(a).val(),l)+"</li>"),t+="<li>"+wpseoMetaboxL10n.page_title_text+ptest(jQuery("#wpseosnippet_title_"+e).text(),l)+"</li>",t+="<li>"+wpseoMetaboxL10n.page_url_text+ptest(o,n)+"</li>",jQuery(s).length&&(t+="<li>"+wpseoMetaboxL10n.content_text+ptest(jQuery(s).val(),l)+"</li>"),t+="<li>"+wpseoMetaboxL10n.meta_description_text+ptest(r,l)+"</li>",p.html(t+="</ul>")):p.html("")}"undefined"!=typeof wpseoMetaboxL10n&&(r=function(e,a){var t="",s=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+a),o=jQuery("#"+wpseoMetaboxL10n.field_prefix+"title-length-warning_"+a),n=jQuery("<div />"),l=jQuery("#wpseosnippet_title_"+a);if(""==(t=s.val()?s.val():(t=wpseoMetaboxL10n.wpseo_title_template,n.html(t).text())))return l.html(""),void o.hide();t=yst_clean(t),t=jQuery.trim(t),t=n.text(t).html(),e&&s.val(t),t=function(t,e,a){if(void 0===t)return"";if("undefined"==typeof replacedVars&&0==jQuery("#title").size())return t;var s="#title",o="#excerpt-"+e,n="#content";if(e!=WPGlobusAdmin.data.default_language&&(s="#title_"+e,n="#content_"+e),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=jQuery(s).length?t.replace(/%%title%%/g,jQuery(s).val()):t).replace(/%%sitedesc%%/g,WPGlobusAdmin.data.blogdescription[e])).replace(/%%sitename%%/g,WPGlobusAdmin.data.blogname[e])).replace(/%%sep%%/g,wpseoMetaboxL10n.sep)).replace(/%%date%%/g,wpseoMetaboxL10n.date)).replace(/%%id%%/g,wpseoMetaboxL10n.id)).replace(/%%page%%/g,wpseoMetaboxL10n.page)).replace(/%%currenttime%%/g,wpseoMetaboxL10n.currenttime)).replace(/%%currentdate%%/g,wpseoMetaboxL10n.currentdate)).replace(/%%currentday%%/g,wpseoMetaboxL10n.currentday)).replace(/%%currentmonth%%/g,wpseoMetaboxL10n.currentmonth)).replace(/%%currentyear%%/g,wpseoMetaboxL10n.currentyear)).replace(/%%focuskw%%/g,jQuery("#yoast_wpseo_focuskw_"+e).val()),e="",jQuery(o).length&&(e=yst_clean(jQuery(o).val()),t=t.replace(/%%excerpt_only%%/g,e)),""==e&&jQuery(n).length&&(e=jQuery(n).val().replace(/(<([^>]+)>)/gi,"").substring(0,wpseoMetaboxL10n.wpseo_meta_desc_length-1)),t=t.replace(/%%excerpt%%/g,e),jQuery("#parent_id").length&&jQuery("#parent_id option:selected").text()!=wpseoMetaboxL10n.no_parent_text&&(t=t.replace(/%%parent_title%%/g,jQuery("#parent_id option:selected").text())),e=yst_escapeFocusKw(wpseoMetaboxL10n.sep),e=new RegExp(e+" "+e,"g"),-1!=(t=t.replace(e,wpseoMetaboxL10n.sep)).indexOf("%%")&&null!=t.match(/%%[a-z0-9_-]+%%/i))for(regex=/%%[a-z0-9_-]+%%/gi,matches=t.match(regex),i=0;i<matches.length;i++)null!=replacedVars[matches[i]]?t=t.replace(matches[i],replacedVars[matches[i]]):(replaceableVar=matches[i],replacedVars[replaceableVar]="",jQuery.post(ajaxurl,{action:"wpseo_replace_vars",string:matches[i],post_id:jQuery("#post_ID").val(),_wpnonce:wpseoMetaboxL10n.wpseo_replace_vars_nonce},function(e){e&&(replacedVars[replaceableVar]=e),yst_replaceVariables(t,a)}));a(t)}(t,a,function(e){var t=n.html(e).text();s.attr("placeholder",t),e=_(e=yst_clean(e),!1,a),jQuery("#wpseosnippet_title_"+a).html(e);e=document.getElementById("wpseosnippet_title_"+a);null!=e&&(e.scrollWidth>e.clientWidth?o.show():o.hide()),y(a)})},p=function(e){r(!1,e),w(e)},jQuery("#wpglobus-wpseo-tabs").tabs(),e=jQuery("#wpglobus-wpseo-attr"),u=jQuery(".wpseotab.general .form-table"),g=e.data("ids"),c=e.data("names"),d="",g=(g=g+","+e.data("qtip")).split(","),c=c.split(","),jQuery("#wpglobus-wpseo-tabs").insertBefore(u),jQuery(".wpglobus-wpseo-general").each(function(e,t){var n,l,s=jQuery(t),o=s.data("language");s.html('<table class="form-table wpglobus-table-'+o+'" data-language="'+o+'">'+u.html()+"</table>"),jQuery.each(c,function(e,t){jQuery("#"+t).attr("name",t+"_"+o)}),jQuery.each(g,function(e,t){var a=jQuery("#"+t);"wpseosnippet"==t&&a.addClass("wpglobus-wpseosnippet"),"focuskwresults"==t&&a.addClass("wpglobus-focuskwresults"),wpseoMetaboxL10n.field_prefix+"metadesc"==t&&a.addClass("wpglobus-wpseo_metadesc").text(s.data("metadesc")),wpseoMetaboxL10n.field_prefix+"title"==t&&a.addClass("wpglobus-wpseo_title").val(s.data("wpseotitle")),wpseoMetaboxL10n.field_prefix+"focuskw"==t&&a.addClass("wpglobus-wpseo_focuskw").val(s.data("focuskw")),a.attr("id",t+"_"+o),jQuery("#"+t+"_"+o).attr("data-language",o)}),d="complete"==s.data("permalink")?s.data("url-"+o):s.data("url-"+o)+jQuery("#editable-post-name-full").text()+"/",jQuery("#wpseosnippet_"+o+" .url").text(d),p(o),void 0!==jQuery().autocomplete&&(n={},jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+o).autocomplete({minLength:3,formatResult:function(e){return jQuery("<div/>").html(e).html()},source:function(e,s){var o=e.term;o in n?s(n[o]):(e._ajax_nonce=wpseoMetaboxL10n.wpseo_keyword_suggest_nonce,e.action="wpseo_get_suggest",l=jQuery.getJSON(ajaxurl,e,function(e,t,a){n[o]=e,a===l&&s(e)}))}})),jQuery("#"+wpseoMetaboxL10n.field_prefix+"title_"+o).keyup(function(){r(!1,jQuery(this).data("language"))}),jQuery("#title_"+o).keyup(function(){var e=jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language;r(!1,e),w(e)}),0==e&&jQuery("#title").keyup(function(){r(!1,WPGlobusAdmin.data.default_language),w(WPGlobusAdmin.data.default_language)}),0==e&&jQuery("body").on("change","#parent_id",function(){jQuery.each(WPGlobusAdmin.data.enabled_languages,function(e,t){r(!1,t),w(t)})}),jQuery("#"+wpseoMetaboxL10n.field_prefix+"metadesc_"+o).keyup(function(){w(jQuery(this).data("language"))}),jQuery("body").on("keyup","#excerpt-"+o,function(){w(jQuery(this).data("language")?jQuery(this).data("language"):WPGlobusAdmin.data.default_language)}),0==e&&jQuery(".wpglobus-editor").focusout(function(){w(jQuery(this).data("language"))});var a=!1;jQuery(document).on("change","#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+o,function(){var e=jQuery(this).data("language"),t=jQuery("#focuskwhelp_"+e);-1!=jQuery("#"+wpseoMetaboxL10n.field_prefix+"focuskw_"+e).val().search(",")?(t.click(),a=!0):a&&(t.qtip("hide"),a=!1),p(e)})}),u.addClass("hidden"),jQuery("body").on("change",".wpglobus-wpseo_metadesc",function(e){var t="#"+wpseoMetaboxL10n.field_prefix+"metadesc",a=jQuery(this);jQuery(t).val(WPGlobusCore.getString(jQuery(t).val(),a.val(),a.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_title",function(e){var t="#"+wpseoMetaboxL10n.field_prefix+"title",a=jQuery(this);jQuery(t).val(WPGlobusCore.getString(jQuery(t).val(),a.val(),a.data("language")))}),jQuery("body").on("change",".wpglobus-wpseo_focuskw",function(e){var t="#"+wpseoMetaboxL10n.field_prefix+"focuskw",a=jQuery(this);jQuery(t).val(WPGlobusCore.getString(jQuery(t).val(),a.val(),a.data("language")))}),jQuery("body").on("click",".wpglobus-post-body-tabs-list li",function(e){$this=jQuery(this),$this.hasClass("wpglobus-post-tab")&&jQuery("#wpglobus-wpseo-tabs").tabs("option","active",jQuery(this).data("order"))}),jQuery(".yoast_help").qtip({content:{attr:"alt"},position:{my:"bottom left",at:"top center"},style:{tip:{corner:!0},classes:"yoast-qtip qtip-rounded qtip-blue"},show:{when:{event:"mouseover"}},hide:{fixed:!0,when:{event:"mouseout"}}}),yst_updateSnippet())};