"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _iterableToArrayLimit(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var o,a,l=[],r=!0,s=!1;try{for(n=n.call(e);!(r=(o=n.next()).done)&&(l.push(o.value),!t||l.length!==t);r=!0);}catch(e){s=!0,a=e}finally{try{r||null==n.return||n.return()}finally{if(s)throw a}}return l}}function _arrayWithHoles(e){if(Array.isArray(e))return e}jQuery(document).ready(function($){var api={counter:0,noticeOn:!1,initDone:!1,languageSelectorBoxDelta:0,oldLanguageSelector:!1,languageSelectorEnabled:!0,parseBool:function(e){return!/^(false|0)$/i.test(e)&&!!e},getCounter:function(e){return api.counter},getOptionKey:function(e){return e=e||"",WPGlobusGutenberg.keyOption[e]},getOptions:function(){return WPGlobusGutenberg.options},isOldLanguageSelector:function(){return api.oldLanguageSelector},isPostDisabled:function(){return WPGlobusGutenberg.__post.disabled},isEnabledTab:function(e){var t=!1;return t="options"==(e=void 0===e?"options":e)&&api.parseBool(WPGlobusGutenberg.enabledOptionsTab)?!0:t},init:function(){WPGlobusGutenberg.yoastSeo=api.parseBool(WPGlobusGutenberg.yoastSeo),WPGlobusGutenberg.elementor=api.parseBool(WPGlobusGutenberg.elementor),api.isPostDisabled()||(api.initListeners(),api.initNotifications(),api.setTabs(),api.formHandler(),api.attachListeners())},initListeners:function(){WPGlobusGutenberg.yoastSeo&&1==$(".yoast.wpseo-metabox").length&&$(window).on("beforeunload",function(e){e.stopImmediatePropagation()})},formHandler:function(){var e=$(".metabox-base-form #referredby").attr("value");void 0!==e&&(e=-1==e.indexOf("language=en")?e+"&language="+WPGlobusGutenberg.language:e.replace("language=en","language="+WPGlobusGutenberg.language),$(".metabox-base-form #referredby").attr("value",e)),void 0!==(e=$('input[name="_wp_original_http_referer"]').attr("value"))&&(e=-1==e.indexOf("language=en")?e+"&language="+WPGlobusGutenberg.language:e.replace("language=en","language="+WPGlobusGutenberg.language),$('input[name="_wp_original_http_referer"]').attr("value",e))},initNotifications:function(){void 0!==wp.editPost&&void 0!==wp.plugins&&WPGlobusGutenberg.elementor&&"internal"==WPGlobusGutenberg.data.elementorCssPrintMethod&&wp.data.dispatch("core/notices").createNotice("error",WPGlobusGutenberg.i18n.elementorWarning,{id:"elementorcssprintmethodnotice",isDismissible:!0,actions:[{url:WPGlobusGutenberg.i18n.elementorActionLink,label:WPGlobusGutenberg.i18n.elementorActionLabel}]})},setTabs:function(){var t;0!=WPGlobusGutenberg.tabs.length?(api.oldLanguageSelector=!0,t=setInterval(function(){var e=$(".edit-post-header__settings");1==e.length&&(e.before(WPGlobusGutenberg.tabs),clearInterval(t))},200)):api.WPGlobusSwitcherPlugin()},setSelectorStatus:function(){var e;api.isOldLanguageSelector()&&($(".wpglobus-gutenberg-selector-box").css({opacity:"0.2"}).attr("onclick","return false;"),api.languageSelectorEnabled=!1,e=setInterval(function(){if(0==$(".is-saving").length){if(clearInterval(e),WPGlobusGutenberg.pagenow==WPGlobusGutenberg.postNewPage&&-1!=location.pathname.indexOf(WPGlobusGutenberg.postEditPage))return WPGlobusGutenberg.pagenow=WPGlobusGutenberg.postEditPage,$(".wpglobus-gutenberg-selector-box").css({opacity:"1"}).attr("onclick",""),void api.reloadPage();api.languageSelectorEnabled=!0,$(".wpglobus-gutenberg-selector-box").css({opacity:"1"}).attr("onclick","")}},400))},reloadPage:function(){$(".wpglobus-selector-grid").css({"grid-template-columns":"10% 90%"}),$(".wpglobus-gutenberg-selector-text").text(WPGlobusGutenberg.i18n.reload),function e(){$(".wpglobus-gutenberg-selector").fadeOut(500).fadeIn(500,e)}(),setTimeout(function(){location.reload()},500)},attachListeners:function(){api.isOldLanguageSelector()&&($(document).on("mouseenter",".wpglobus-gutenberg-selector",function(e){api.languageSelectorEnabled&&($(".wpglobus-gutenberg-selector-dropdown").css({display:"block"}),api.languageSelectorBoxDelta=e.screenY,$(".edit-post-header").css({"z-index":"100000"}),$(".wpglobus-gutenberg-selector-box").css({"z-index":"100001"}))}),$(document).on("mouseleave",".wpglobus-gutenberg-selector",function(e){0!=api.languageSelectorBoxDelta&&e.screenY-api.languageSelectorBoxDelta<=0&&($(".wpglobus-gutenberg-selector-dropdown").css({display:"none"}),$(".edit-post-header").css({"z-index":"9989"}),$(".wpglobus-gutenberg-selector-box").css({"z-index":"100"}))}),$(document).on("mouseleave",".wpglobus-gutenberg-selector-dropdown",function(e){$(".wpglobus-gutenberg-selector-dropdown").css({display:"none"}),$(".edit-post-header").css({"z-index":"9989"}),$(".wpglobus-gutenberg-selector-box").css({"z-index":"10000"})}),$(document).on("click",".editor-post-save-draft",function(){api.setSelectorStatus()}),$(document).on("click",".editor-post-publish-button",function(){api.setSelectorStatus()}))},WPGlobusSwitcherPlugin:function WPGlobusSwitcherPlugin(){if(void 0!==wp.editPost&&void 0!==wp.plugins){var useState=wp.element.useState,language=WPGlobusGutenberg.language,enabledLanguages=WPGlobusCoreData.enabled_languages,languageNames=WPGlobusCoreData.en_language_name,flagsUrl=WPGlobusGutenberg.flags_url,switcherButtonTitle="WPGlobus Switcher",ref=location.href,refs={},key;for(key in enabledLanguages)-1==ref.indexOf("language="+language)?refs[enabledLanguages[key]]=ref+"&language="+enabledLanguages[key]:refs[enabledLanguages[key]]=ref.replace("language="+language,"language="+enabledLanguages[key]);var __=wp.i18n.__,el=wp.element.createElement,Fragment=wp.element.Fragment,TabPanel=wp.components.TabPanel,RadioControl=wp.components.RadioControl,Notice=wp.components.Notice,Button=wp.components.Button,TextControl=wp.components.TextControl,CheckboxControl=wp.components.CheckboxControl,PluginSidebarMoreMenuItem=wp.editPost.PluginSidebarMoreMenuItem,PanelBody=wp.components.PanelBody,PluginSidebar=wp.editPost.PluginSidebar,registerPlugin=wp.plugins.registerPlugin,pluginStarButton=$(".components-panel__header.edit-post-sidebar-header button.components-icon-button").eq(0),switcherButtonHTML={flagOnly:'<img height="20" width="20" style="width:20px;" src="'+WPGlobusGutenberg.flags_url[WPGlobusGutenberg.language]+'" />',flagLanguage:'<img height="20" width="20" style="width:20px;" src="'+WPGlobusGutenberg.flags_url[WPGlobusGutenberg.language]+'" />&nbsp;'+WPGlobusAdmin.data.en_language_name[WPGlobusGutenberg.language],flagCode:'<img height="20" width="20" style="width:20px;" src="'+WPGlobusGutenberg.flags_url[WPGlobusGutenberg.language]+'" />&nbsp;'+WPGlobusGutenberg.language,languageOnly:"&nbsp;"+WPGlobusAdmin.data.en_language_name[WPGlobusGutenberg.language],languageCode:"&nbsp;"+WPGlobusGutenberg.language},switcherPluginButtonType="",promisedPluginButtonType="",optionSwitcherButtonType=api.getOptionKey("switcherButtonType");setSwitcherButtonType(WPGlobusGutenberg.options[optionSwitcherButtonType]),promisedPluginButtonType=getSwitcherButtonType(),$(document).on("click",pluginStarButton,function(){setSwitcherPluginButton()});var languageList=function(){return WPGlobusGutenberg.pagenow==WPGlobusGutenberg.postNewPage?el("div",{style:{marginBottom:"20px"},className:"wpglobus-switcher-panel__switcher-notice"},WPGlobusGutenberg.i18n.save_post):el("ul",{className:"language-list"},enabledLanguages.map(function(e){return el("li",{key:e,className:"language-item"},el("img",{style:{marginRight:"7px",width:"20px"},className:"wpglobus-switcher-panel__flag",height:"20",width:"20",src:flagsUrl[e]}),el(Button,{href:refs[e],isSmall:!0,isPrimary:!0},languageNames[e]))}))},InputText=function(e){var t=e.className,n=void 0===t?"":t,o=e.style,a=void 0===o?"":o,t=e.value,o=e.placeholder,e=void 0===o?"":o,o=_slicedToArray(useState(void 0===t?"":t),2),t=o[0],l=o[1],o="components-text";""!==n&&(o+=" "+n);return el("input",{type:"text",value:t,className:o,style:a,placeholder:e,onChange:function(e){l(e.target.value)}})},getEl=function getEl(elProps){var language=elProps.language,key=elProps.key,tagName=elProps.tagName,callBack=elProps.callBack,children=elProps.children,props=Object.assign({},elProps.props);props.key=key;var type="htmlElement";if(tagName[0]===tagName[0].toUpperCase()&&(type="ReactComponent"),props=replace(props,language),null!==children&&(children=replace(children,language)),"htmlElement"===type)return props.className="components-"+tagName+" "+props.className,el(tagName,props,children);var component=null;switch(tagName){case"Button":component=el(Button,props,children);break;case"InputText":component=el(InputText,props);break;case"__SomeElement__":break;default:if("string"==typeof callBack){props.tagName=tagName,props.language=language,props.children=children;try{component=el(eval(callBack).getComponent,props)}catch(e){console.log("Incorrect PubStatus callBack: ",callBack)}}}return component},replace=function n(o,a){return"string"==typeof o?-1!==o.indexOf("{{")&&(-1!==o.indexOf("{{LanguageName}}")?o=o.replace("{{LanguageName}}",WPGlobusAdmin.data.en_language_name[a]):-1!==o.indexOf("{{flagUrl}}")?o=o.replace("{{flagUrl}}",flagsUrl[a]):-1!==o.indexOf("{{href}}")&&(o=o.replace("{{href}}",refs[a]))):"object"===_typeof(o)&&Object.entries(o).forEach(function(e){var t=_slicedToArray(e,2),e=t[0],t=t[1];"style"!==e&&(o[e]=n(t,a))}),o},SwitcherPluginButton=function(){var e=_slicedToArray(useState(promisedPluginButtonType),2),t=e[0],n=e[1];return el(RadioControl,{label:"",help:"Select type of switcher language button.",selected:t,className:"wpglobus-switcher-components-radio-control",options:[{label:"Flag only",value:"flagOnly"},{label:"Flag with language",value:"flagLanguage"},{label:"Flag with language code",value:"flagCode"},{label:"Language only",value:"languageOnly"},{label:"Language code",value:"languageCode"}],onChange:function(e){n(e),setOption(optionSwitcherButtonType,e)}})};registerPlugin("wpglobus-switcher",{icon:"",render:MainSwitcher})}function setSwitcherButtonType(e){switcherPluginButtonType=e=e||"flagLanguage"}function getSwitcherButtonType(){return switcherPluginButtonType}function getSwitcherButtonTitle(){return switcherButtonTitle}function rbAnimate(e){void 0===e&&(e=!0);var t=document.querySelectorAll(".wpglobus-switcher-components-radio-control .components-radio-control__input");0!=t.length&&(e?(t.forEach(function(e){e.classList.add(e.value),e.classList.remove("wpglobus-switcher-pulsate-radio"),e.classList.add("wpglobus-switcher-pulsate-radio-off")}),(e=document.querySelector(".wpglobus-switcher-components-radio-control ."+promisedPluginButtonType)).classList.remove("wpglobus-switcher-pulsate-radio-off"),e.classList.add("wpglobus-switcher-pulsate-radio")):t.forEach(function(e){e.classList.remove("wpglobus-switcher-pulsate-radio"),e.classList.remove("wpglobus-switcher-pulsate-radio-off"),e.classList.add("wpglobus-switcher-pulsate-radio-on")}))}function notice(e,t){void 0===e||api.noticeOn||(api.noticeOn=!0,e.innerText=t,e.classList.remove("hidden"),setTimeout(function(){e.classList.add("hidden"),api.noticeOn=!1},3e3))}function setOption(e,t){t=t||"",optionSwitcherButtonType==(e=e||"")&&saveOptions(e,t).then(function(e){"success"==e.result&&(setSwitcherButtonType(t),setSwitcherPluginButton(WPGlobusGutenberg.options[optionSwitcherButtonType]=t))}).fail(function(e){var t=document.getElementsByClassName("wpglobus-switcher-error-message");void 0!==t[0]&&("error"==e.result?notice(t[0],e.message):400==e.status&&notice(t[0],"Error: "+e.status+" ("+e.statusText+")"),promisedPluginButtonType=getSwitcherButtonType());e=document.getElementsByClassName("wpglobus-panel-tab-options");void 0!==e[0]&&-1!=e[0].classList.value.indexOf("is-active")&&e[0].click()}).always(function(){})}function saveOptions(e,t){if(""!=(e=e||"")){var n={sender:"WPGlobusGutenberg",_action:"saveOption",is_admin:1};return n.counter=api.counter++,n.options={},n.options[e]=t,wp.ajax.post(WPGlobusGutenberg.wpglobusAjax,{data:n})}}function getSwitcherButton(e){return void 0===switcherButtonHTML[e]&&(e=switcherPluginButtonType),switcherButtonHTML[e]}function setSwitcherPluginButton(n){void 0!==n&&void 0!==switcherButtonHTML[n]||(n=switcherPluginButtonType),setTimeout(function(){var e,t=document.querySelector('[aria-label="'+getSwitcherButtonTitle()+'"]');null!=t&&(void 0===t.dataset.status?(e=t.innerHTML,t.innerHTML=e+getSwitcherButton(n),t.dataset.status="init"):(t.innerHTML=getSwitcherButton(n),t.dataset.status="changed"))},300)}function languageListEl(){if("object"!==_typeof(WPGlobusGutenberg.switcherItems))return el("div",{key:0,className:"container wpglobus-switcher-message wpglobus-switcher-error-message",style:{position:"initial"}},"Error: Invalid switcherItems object");function n(l,e){var r=[];return Object.entries(WPGlobusGutenberg.switcherItems).map(function(e,t){var n,o=e[0],a=e[1].elements;r.push(el("div",{key:t,className:"container container-"+o+" "+e[1].containerClassName},(n=l,a.map(function(e,t){return getEl($.extend({language:n,key:t},e))}))))}),r}var e=enabledLanguages.map(function(e,t){return el("li",{key:t,className:"language-item"},n(e))});return el("ul",{className:"language-list"},e)}function onTabSelect(e){return"switcher"===e.name?SwitcherTabContent():"options"===e.name?OptionsTabContent():void 0}function TabLayout(){var e=[{name:"switcher",title:"Languages",className:"wpglobus-panel-tab wpglobus-panel-tab-selector edit-post-sidebar__panel-tab"}];return WPGlobusGutenberg.isEnabledTab("options")&&e.push({name:"options",title:"Options",className:"wpglobus-panel-tab wpglobus-panel-tab-options edit-post-sidebar__panel-tab"}),el(TabPanel,{name:"WPGlobusSwitcherTabPanel",className:"wpglobus-tab-panel",activeClass:"is-active",tabs:e},onTabSelect)}function SwitcherTabContent(){return el("div",{className:"wpglobus-tab-content wpglobus-selector-tab-content"},el(Notice,{className:"wpglobus-switcher-panel__notice",status:"informational",isDismissible:!1},__("Select language")),el("div",{className:"wpglobus-switcher-panel__switcher-box"},languageListEl()),el(Button,{className:"wpglobus-switcher-panel__button-link wpglobus-switcher-panel__info",href:WPGlobusGutenberg.store_link,isLink:!0,target:"_blank"},__("WPGlobus Premium")),el(Button,{className:"wpglobus-switcher-panel__button-link wpglobus-switcher-panel__settings-link",href:WPGlobusGutenberg.options_page_url,isLink:!0},__("WPGlobus Options")))}function OptionsTabContent(){return el("div",{className:"wpglobus-tab-content wpglobus-options-tab-content"},el(Notice,{className:"wpglobus-switcher-panel__notice",status:"informational",isDismissible:!1},__("Select type")),el(SwitcherPluginButton,null))}function MainSwitcher(){return setSwitcherPluginButton(),el(Fragment,{},el(PluginSidebarMoreMenuItem,{target:"wpglobus-switcher-sidebar",icon:"admin-site"},__("WPGlobus")),el(PluginSidebar,{name:"wpglobus-switcher-sidebar",title:getSwitcherButtonTitle(),className:"wpglobus-switcher-components-panel"},el("div",{className:"wpglobus-switcher-message wpglobus-switcher-error-message hidden",style:{}},""),el(PanelBody,{className:"wpglobus-switcher-panel__body"},TabLayout())))}}};WPGlobusGutenberg=$.extend({},WPGlobusGutenberg,api),WPGlobusGutenberg.init()});